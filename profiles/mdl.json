{
  "remote_storage": {
    "AWS_ACCESS_KEY_ID": "<key here>",
    "AWS_SECRET_ACCESS_KEY": "<key here>",
    "AWS_REGION": "us-west-2",
    "AWS_BUCKET": "dpla.hub.umn.mdl"
  },
  "validator": {
    "base_url": "http://localhost:8083/api/v1/validate",
    "api_key": "<key here>",
    "dpla_api_key": "<key here>"
  },
  "extractor": {
    "records": {
      "base_url": "http://localhost:8083/api/v1/extract",
      "endpoint_type": "oai_dc",
      "api_key": "<key here>",
      "origin_path": "records",
      "endpoint": "http://reflections.mndigital.org/oai/oai2.php",
      "cache_response": "2.weeks",
      "allow_parallel_extraction": false
    },
    "enrichments": [
      {
        "url": "http://localhost:8083/api/v1/extract?endpoint=http://reflections.mndigital.org/oai/oai2.php&endpoint_type=oai_dc&api_key=<key here>&verb=ListSets",
        "key": "listSets"
      }
    ]
  },
  "transformer": {
    "base_url": "http://localhost:8083/api/v1/transform",
    "api_key": "<key here>",
    "@context": {
      "edm": "http://www.europeana.eu/schemas/edm/",
      "isShownAt": "edm:isShownAt",
      "dpla": "http://dp.la/terms/",
      "dataProvider": "edm:dataProvider",
      "aggregatedDigitalResource": "dpla:aggregatedDigitalResource",
      "state": "dpla:state",
      "hasView": "edm:hasView",
      "provider": "edm:provider",
      "collection": "dpla:aggregation",
      "object": "edm:object",
      "stateLocatedIn": "dpla:stateLocatedIn",
      "begin": {
        "@type": "xsd:date",
        "@id": "dpla:dateRangeStart"
      },
      "@vocab": "http://purl.org/dc/terms/",
      "LCSH": "http://id.loc.gov/authorities/subjects",
      "sourceResource": "edm:sourceResource",
      "name": "xsd:string",
      "coordinates": "dpla:coordinates",
      "end": {
        "@type": "xsd:date",
        "@id": "dpla:dateRangeEnd"
      },
      "originalRecord": "dpla:originalRecord"
    },
"fields": {
      "pushToDPLA": {
        "origins": [
          {
            "value": true
          }
        ]
      },
      "isShownAt": {
        "origins": [
          {
            "path": "metadata/dc/identifier[last()]"
          }
        ]
      },
      "sourceResource/extent": {
        "origins": [
          {
            "path": "metadata/dc/format[first()]"
          }
        ]
      },
      "object": {
        "origins": [
          {
            "path": "header/identifier"
          }
        ],
        "processors": [
          {
            "process": "gsub",
            "args": {
              "pattern": "oai:reflections.mndigital.org:",
              "replacement": ""
            }
          },
          {
            "process": "gsub",
            "args": {
              "pattern": "/",
              "replacement": "&CISOPTR="
            }
          },
          {
            "process": "affix",
            "args": {
              "prefix": "http://reflections.mndigital.org/cgi-bin/thumbnail.exe?CISOROOT=/"
            }
          }
        ]
      },
      "dataProvider": {
        "origins": [
          {
            "path": "metadata/dc/publisher"
          }
        ]
      },
      "sourceResource/publisher": {
        "origins": [
          {
            "path": "metadata/dc/source"
          }
        ]
      },
      "provider": {
        "origins": [
          {
            "value": {
              "@id": "http://dp.la/api/contributor/mdl",
              "name": "Minnesota Digital Library"
            }
          }
        ]
      },
      "title": {
        "origins": [
          {
            "path": "metadata/dc/title"
          }
        ],
        "processors": [
          {
            "process": "strip"
          },
          {
            "process": "gsub",
            "args": {
              "pattern": "\\s+\\s+",
              "replacement": " "
            }
          }
        ]
      },
      "sourceResource/title": {
        "origins": [
          {
            "path": "metadata/dc/title"
          }
        ],
        "processors": [
          {
            "process": "strip"
          },
          {
            "process": "gsub",
            "args": {
              "pattern": "\\s+\\s+",
              "replacement": " "
            }
          }
        ]
      },
      "sourceResource/spatial": {
        "origins": [
          {
            "path": "metadata/dc/coverage"
          }
        ],
        "processors": [
          {
            "process": "geonames_postal",
            "args": {
              "username": "umntestuser",
              "defaults": [
                {
                  "matches": [
                    [
                      "Minneapolis",
                      "Downtown",
                      "Hennepin",
                      "Minnesota",
                      "United States"
                    ],
                    [
                      "Minneapolis",
                      "Hennepin",
                      "Minnesota",
                      "United States"
                    ],
                    [
                      "Minneapolis",
                      "Minnesota",
                      "United States"
                    ],
                    [
                      "Minneapolis",
                      "Minnesota"
                    ],
                    [
                      "Minneapolis"
                    ]
                  ],
                  "returns": {
                    "county": "Hennepin County",
                    "name": "Minneapolis",
                    "state": "Minnesota",
                    "coordinates": [
                      "44.9871, -93.2737"
                    ],
                    "country": "United States"
                  }
                }
              ]
            }
          }
        ]
      },
      "sourceResource/subject": {
        "label": "name",
        "origins": [
          {
            "path": "metadata/dc/subject"
          }
        ],
        "processors": [
          {
            "process": "split",
            "args": [
              "; "
            ]
          },
          {
            "process": "flatten"
          },
          {
            "process": "unique"
          },
          {
            "process": "strip"
          },
          {
            "process": "gsub",
            "args": {
              "pattern": "\\s--\\s",
              "replacement": "--"
            }
          },
          {
            "process": "gsub",
            "args": {
              "pattern": ";",
              "replacement": ""
            }
          }
        ]
      },
      "sourceResource/date/begin": {
        "origins": [
          {
            "path": "metadata/dc/date"
          }
        ],
        "processors": [
          {
            "process": "gsub",
            "args": {
              "pattern": "\\?",
              "replacement": ""
            }
          },
          {
            "process": "split",
            "args": [
              " - "
            ]
          },
          {
            "process": "first"
          }
        ]
      },
      "sourceResource/date/end": {
        "origins": [
          {
            "path": "metadata/dc/date"
          }
        ],
        "processors": [
          {
            "process": "gsub",
            "args": {
              "pattern": "\\?",
              "replacement": ""
            }
          },
          {
            "process": "split",
            "args": [
              " - "
            ]
          },
          {
            "process": "last"
          }
        ]
      },
      "sourceResource/date/displayDate": {
        "origins": [
          {
            "path": "metadata/dc/date"
          }
        ]
      },
      "sourceResource/creator": {
        "origins": [
          {
            "path": "metadata/dc/creator"
          }
        ],
        "processors": [
          {
            "process": "gsub",
            "args": {
              "pattern": "\\.",
              "replacement": ""
            }
          }
        ]
      },
      "sourceResource/description": {
        "origins": [
          {
            "path": "metadata/dc/description"
          }
        ],
        "processors": [
          {
            "process": "strip"
          },
          {
            "process": "gsub",
            "args": {
              "pattern": "\\s+\\s+",
              "replacement": " "
            }
          }
        ]
      },
      "sourceResource/contributor": {
        "origins": [
          {
            "path": "metadata/dc/contributor"
          }
        ]
      },
      "sourceResource/format": {
        "origins": [
          {
            "path": "metadata/dc/format[last()]||metadata/dc/format"
          }
        ],
        "processors": [
          {
            "process": "strip"
          },
          {
            "process": "flatten"
          },
          {
            "process": "join",
            "args": [
              ""
            ]
          },
          {
            "process": "gsub",
            "args": {
              "pattern": ";",
              "replacement": ""
            }
          }
        ]
      },
      "sourceResource/rights": {
        "origins": [
          {
            "path": "metadata/dc/rights"
          }
        ],
        "processors": [
          {
            "process": "strip"
          },
          {
            "process": "gsub",
            "args": {
              "pattern": "\\s+\\s+",
              "replacement": " "
            }
          }
        ]
      },
      "sourceResource/relation": {
        "origins": [
          {
            "path": "metadata/dc/relation"
          }
        ],
        "processors": [
          {
            "process": "split",
            "args": [
              ";"
            ]
          },
          {
            "process": "strip"
          }
        ]
      },
      "sourceResource/collection/title": {
        "lookup_keys": [
          {
            "token": "$setSpec",
            "path": "header/setSpec"
          }
        ],
        "origins": [
          {
            "path": "enrichments/listSets/records/$setSpec/setDescription/oclcdc/title"
          }
        ]
      },
      "sourceResource/collection/description": {
        "lookup_keys": [
          {
            "token": "$setSpec",
            "path": "header/setSpec"
          }
        ],
        "origins": [
          {
            "path": "enrichments/listSets/records/$setSpec/setDescription/oclcdc/description"
          }
        ]
      },
      "sourceResource/type": {
        "origins": [
          {
            "path": "metadata/dc/type"
          }
        ]
      },
      "identifier": {
        "origins": [
          {
            "path": "header/identifier"
          }
        ]
      }
    }
  }
}
